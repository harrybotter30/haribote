Next: [harib07a](harib07a.md), Previous: [harib06c](harib06c.md), Up: [Chapter9](chapter9.md)

----

# Chapter9

## harib06d

### 課題

メモリ管理を行う。

### 学習

メモリ管理にはいくつか方法がある。

- メモリブロックを利用しているかしていないかをビットマップで管理する方法
- メモリの空き領域の場所とサイズをテーブル管理する方法

この二つの方法の利点・欠点はちょうど裏返しになっている。

- 前者の利点
    - メモリ管理領域のサイズが固定
    - メモリの確保・解放の処理が単純
- 前者の欠点
    - メモリ管理領域のサイズが大きくなる
    - メモリの確保・解放に時間がかかる
- 後者者の利点
    - メモリ管理領域のサイズが小さい
    - メモリの確保・解放が高速
- 後者の欠点
    - メモリ管理領域のサイズが可変
    - メモリの確保・解放の処理が複雑

ここでは後者の方法を採用する。  
メモリ管理領域のサイズが可変という問題に関しては、開放した領域を忘れるという対応（！）で回避する。

具体的には struct MEMMAN は 0x003c0000(3.75MB) からの 32KB の領域に配置し、

- 0x00001000 から 0x0009e000（4KB から 632KB）
- 0x00400000 からメモリ実装上限（4MB からメモリ実装上限）

をメモリ管理の対象とする。

### 成果

- [bootpack.c](/bootpack.c)
    - memman\_init(), memman\_total(), memman\_alloc(), memman\_free() を追加

----

Next: [harib07a](harib07a.md), Previous: [harib06c](harib06c.md), Up: [Chapter9](chapter9.md)
